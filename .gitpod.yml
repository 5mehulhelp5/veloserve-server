# Ona Configuration for VeloServe
# Open in Ona: https://ona.com/#https://github.com/veloserve/veloserve
#
# This configuration provides:
# - Rust development environment
# - PHP 8.3 with WordPress/Magento extensions
# - One-click WordPress demo setup

image:
  file: .gitpod.Dockerfile

tasks:
  - name: Build VeloServe
    init: |
      echo "ğŸ“¦ Installing PHP extensions..."
      sudo apt-get update && sudo apt-get install -y php-sqlite3 php-mysql php-curl php-gd php-mbstring php-xml php-zip php-intl php-bcmath || true
      echo "ğŸ”¨ Building VeloServe..."
      cargo build
      echo "âœ… Build complete!"
    command: |
      echo ""
      echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
      echo "â•‘           ğŸš€ VeloServe Development Environment               â•‘"
      echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
      echo "â•‘                                                              â•‘"
      echo "â•‘  Quick Commands:                                             â•‘"
      echo "â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â•‘"
      echo "â•‘  make run              Start VeloServe (basic demo)          â•‘"
      echo "â•‘  make wordpress        ğŸ†• Start with WordPress!              â•‘"
      echo "â•‘  make test             Run tests                             â•‘"
      echo "â•‘                                                              â•‘"
      echo "â•‘  After starting, click the ğŸŒ globe icon on port 8080        â•‘"
      echo "â•‘                                                              â•‘"
      echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
      echo ""

  - name: WordPress Setup (Optional)
    init: |
      echo "ğŸ“¦ Pre-downloading WordPress..."
      bash .devcontainer/wordpress-setup.sh || true

ports:
  - port: 8080
    onOpen: notify
    visibility: public
    name: VeloServe HTTP
    description: VeloServe Web Server (WordPress/Demo)

  - port: 443
    onOpen: ignore
    visibility: private
    name: VeloServe HTTPS

vscode:
  extensions:
    - rust-lang.rust-analyzer
    - tamasfe.even-better-toml
    - serayuzgur.crates
    - bmewburn.vscode-intelephense-client

github:
  prebuilds:
    master: true
    branches: true
    pullRequests: true
    pullRequestsFromForks: false
    addCheck: true
    addComment: false
    addBadge: true
